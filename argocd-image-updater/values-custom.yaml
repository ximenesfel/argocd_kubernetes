# -- Replica count for the deployment. It is not advised to run more than one replica.
replicaCount: 1
image:
  # -- Default image repository
  repository: quay.io/argoprojlabs/argocd-image-updater
  # -- Default image pull policy
  pullPolicy: Always
  # -- Overrides the image tag whose default is the chart appVersion
  tag: ""

# -- The deployment strategy to use to replace existing pods with new ones
updateStrategy:
  type: Recreate
# -- ImagePullSecrets for the image updater deployment
imagePullSecrets: []
# -- Global name (argocd-image-updater.name in _helpers.tpl) override
nameOverride: ""
# -- Global fullname (argocd-image-updater.fullname in _helpers.tpl) override
fullnameOverride: ""

# -- Extra arguments for argocd-image-updater not defined in `config.argocd`.
# If a flag contains both key and value, they need to be split to a new entry
extraArgs: []
  # - --disable-kubernetes
  # - --dry-run
  # - --health-port
  # - 8080
  # - --interval
  # - 2m
  # - --kubeconfig
  # - ~/.kube/config
  # - --match-application-name
  # - staging-*
  # - --max-concurrency
  # - 5
  # - --once
  # - --registries-conf-path
# - /app/config/registries.conf

# -- Extra environment variables for argocd-image-updater
extraEnv: []
  # - name: AWS_REGION
#   value: "us-west-1"

# -- Init containers to add to the image updater pod
initContainers: []
  #  - name: download-tools
  #    image: alpine:3.8
  #    command: [sh, -c]
  #    args:
  #      - wget -qO- https://get.helm.sh/helm-v2.16.1-linux-amd64.tar.gz | tar -xvzf - &&
  #        mv linux-amd64/helm /custom-tools/
  #    volumeMounts:
  #      - mountPath: /custom-tools
#        name: custom-tools

# -- Additional volumeMounts to the image updater main container
volumeMounts: []

# -- Additional volumes to the image updater pod
volumes: []
  ## Use init containers to configure custom tooling
  ## https://argo-cd.readthedocs.io/en/stable/operator-manual/custom_tools/
  ## When using the volumes & volumeMounts section bellow, please comment out those above.
  #  - name: custom-tools
#    emptyDir: {}

config:
  # -- API kind that is used to manage Argo CD applications (`kubernetes` or `argocd`)
  applicationsAPIKind: ""

  # Described in detail here https://argocd-image-updater.readthedocs.io/en/stable/install/running/#flags
  argocd:
    # -- Use the gRPC-web protocol to connect to the Argo CD API
    grpcWeb: true
    # -- Connect to the Argo CD API server at server address
    serverAddress: ""
    # -- If specified, the certificate of the Argo CD API server is not verified.
    insecure: true
    # -- If specified, use an unencrypted HTTP connection to the ArgoCD API instead of TLS.
    plaintext: false
    # -- If specified, the secret with ArgoCD API key will be created.
    token: ""

  # -- Disable kubernetes events
  disableKubeEvents: false

  # -- Username to use for Git commits
  gitCommitUser: "rockemsockem"

  # -- E-Mail address to use for Git commits
  gitCommitMail: "theautomationrules@gmail.com"

  # -- Changing the Git commit message
  gitCommitTemplate: "Commit from ArgoCD Imagen Updater"

  # -- ArgoCD Image Update log level
  logLevel: "info"

  # -- ArgoCD Image Updater registries list configuration. More information [here](https://argocd-image-updater.readthedocs.io/en/stable/configuration/registries/)
  registries: #[]
    # - name: GitHub Container Registry
    #   prefix: ghcr.io
    #   api_url: https://ghcr.io
    #   ping: no
    #   insecure: true
    #   credentials: secret:argocd/git-credentials#creds
    # - name: Docker Hub
    #   api_url: https://registry-1.docker.io
    #   ping: yes
    #   credentials: secret:argocd/docker-credentials#creds
    #   defaultns: library
    # - name: Google Container Registry
    #   api_url: https://gcr.io
    #   prefix: gcr.io
    #   ping: no
    #   credentials: pullsecret:foo/bar
    # - name: RedHat Quay
    #   api_url: https://quay.io
    #   ping: no
    #   prefix: quay.io
    #   credentials: env:REGISTRY_SECRET
    - name: ECR
      api_url: https://127012818163.dkr.ecr.us-east-1.amazonaws.com
      prefix: 127012818163.dkr.ecr.us-east-1.amazonaws.com
      default: true
      ping: yes
      insecure: no
      # credentials: ext:/scripts/ecr-login.sh
      credentials: AWS:eyJwYXlsb2FkIjoiWTlrNC9LeTZZT0JWTGZQbFJJb1BwQ1ZKNnZLaXU4aWxMMlhoc3lvOEY4Z3pBMGlXZWdpUlBuTWFqSk9Ka2ZDcENHR3NMNW1DMUFPU2JhRTRWaHptRkVLWmdWdzhzK004WXVQbGczcTh6dVR3bkhPeXpHUUsvQjhXb3I1am8vZXJqV3kyR3MvUmpKZUpWaTJSZndlamNyWEtYMEhrVTB5dkY5U1pqZEJVVUhzeERRZnpTeXdIOEVJMWUyZERmWTh2MEdXR2xwK2gvVEkwcjZVd3BOVEc0Rmd5MnFvbkJKSVhGVFJBclBBSk10RDJGazNObW9KM3U5dURoS21GMW1DTmVRc3N0akVmOGdTN1EwRUlteExha1U4M2xXZE5iWVpEN1NYV1B5cEk1bHlBc0lITUJJTUlrOGhuU201d2lPQ2tzN0J0Y0pLWGljRWxGSU8wa2xtcmMvNnU0aG92KzR5T1B3cHFJZzd2emJ2dUFjRTF0MCt0MEpvMTRtd2g5TUtBb1NSa1hUSWt1VU5ubEhJWGdMYlhzNGZBKzdNTVU5TmpQNFJtZjFiejFXVnlPTHkrd3c3VUJxSHRNRTZ5TXlJdDdReXpxSk1tTDA1d0xtRzFCUEdnSEdnY21LUTg1UTZWeDlDVHlxTXpyQ05PWnRoU3ZqdkFsSGdvc3BpUTdFaTdsTklIRzRlckNwS3hyTUlGb3UxNTRIMElscEdVR3hxN3QyNGRQLzZmNmo0MEkwNkR1MjJIOEZpMHI1QXVoWFN3c3FoN2VhRlJrL2xyQkxuRkQ0bnpSMTJ5eUNRK2VGcnZTaUVBY2JLOHFJUmtrTEpUM2I2Qks1NjRIZDhzaitsMnJzV0IvRHdtTVpmV0ZSTzFNdnNUWWVKQ3dwUUNhS1lKc1BCL3RnTHExWUV3YWNvbmxKNzYyNk9LOCtHcUc2WmVzMVJ1SUZ5WnFES3p3Mk83S2JRMkRaTXhEUHF4eFY0Z3AwZm1Dek1wSEE5SWhTTVZMNnJXUnRPbFpwZ0lCcDJ5YitSZHhkcDlEREhlYUhyaUlaV3E4UndlM0tFKy9LcEFEcUdDektGd2pzOU1tN1owaENGQXlRamYzRktFdkpBZXRPWkRNUUNYUVlKc2ptQmJCbkdoakk2cXhIOHl3Y01Ub2dQSG9mVitaN2RVNmhaYklnMy8rTWZadTZtQ3hQZ1JXY0cyaVN0K0hUOE9tNzk1WkdiZEIxM0VkMU9RTFZwQzg2LzVoWHJRVTZBWTJaRFhhQ3lHc1dmRjc5dkZaT0VKcE1pTWlzZTcvWEJQSG81LzR2M3o1SVRxUWhlV2V4VGttL1NST1dxclVsb3ZnS0FIV01ZS2g0UnRNdDlwYStZVFFmSXhBU0pQWGZwblhZWnV2Zz09IiwiZGF0YWtleSI6IkFRRUJBSGh3bTBZYUlTSmVSdEptNW4xRzZ1cWVla1h1b1hYUGU1VUZjZTlScTgvMTR3QUFBSDR3ZkFZSktvWklodmNOQVFjR29HOHdiUUlCQURCb0Jna3Foa2lHOXcwQkJ3RXdIZ1lKWUlaSUFXVURCQUV1TUJFRURGWUt3ZjFPRFdKMzBIYys0d0lCRUlBN1Q1aVcxMWNGTG9CejFpdVdhU3RQRE1ZcWdmZElLN2dmeGJ2MS9WYzY0SzJQVERFck03c0p5MWdYVXdEeHN0V09SaGhPTVhNVXRLUy8wUzA9IiwidmVyc2lvbiI6IjIiLCJ0eXBlIjoiREFUQV9LRVkiLCJleHBpcmF0aW9uIjoxNjc5MDYxNzYzfQ==
      credsexpire: 10h

  # -- ArgoCD Image Updater ssh client parameter configuration.
  sshConfig:
    {}
    #  config: |
    #    Host *
    #          PubkeyAcceptedAlgorithms +ssh-rsa
  #          HostkeyAlgorithms +ssh-rsa

# whether to mount authentication scripts, if enabled, the authentication scripts will be mounted on /scripts that can be used to authenticate with registries (ECR)
# refer to https://argocd-image-updater.readthedocs.io/en/stable/configuration/registries/#specifying-credentials-for-accessing-container-registries for more info
authScripts:
  # -- Whether to mount the defined scripts that can be used to authenticate with a registry, the scripts will be mounted at `/scripts`
  enabled: true
  # -- Map of key-value pairs where the key consists of the name of the script and the value the contents
  scripts: 
    ecr-login.sh: |   # notice script name matches above    
      #!/bin/sh
      aws ecr --region us-east-1 get-authorization-token --output text --query 'authorizationData[].authorizationToken' | base64 -d
    # auth1.sh: |
    #   #!/bin/sh
    #   echo "auth script 1 here"
    # auth2.sh: |
    #   #!/bin/sh
  #   echo "auth script 2 here"

serviceAccount:
  # -- Specifies whether a service account should be created
  create: true
  # -- Annotations to add to the service account
  annotations: {}
  # -- The name of the service account to use.
  # If not set and create is true, a name is generated using the fullname template
  name: ""

# -- Pod Annotations for the deployment
podAnnotations: {}

# -- Pod security context settings for the deployment
podSecurityContext: {}
# fsGroup: 2000

# -- Security context settings for the deployment
securityContext: {}
  # capabilities:
  #   drop:
  #   - ALL
  # readOnlyRootFilesystem: true
  # runAsNonRoot: true
# runAsUser: 1000

rbac:
  # -- Enable RBAC creation
  enabled: true

# -- Pod memory and cpu resource settings for the deployment
resources: {}

# -- Kubernetes nodeSelector settings for the deployment
nodeSelector: {}

# -- Kubernetes toleration settings for the deployment
tolerations: []

# -- Kubernetes affinity settings for the deployment
affinity: {}

# Metrics configuration
metrics:
  # -- Deploy metrics service
  enabled: false
  service:
    # -- Metrics service annotations
    annotations: {}
    # -- Metrics service labels
    labels: {}
    # -- Metrics service port
    servicePort: 8081
  serviceMonitor:
    # -- Enable a prometheus ServiceMonitor
    enabled: false
    # -- Prometheus ServiceMonitor interval
    interval: 30s
    # -- Prometheus [RelabelConfigs] to apply to samples before scraping
    relabelings: []
    # -- Prometheus [MetricRelabelConfigs] to apply to samples before ingestion
    metricRelabelings: []
    # -- Prometheus ServiceMonitor selector
    selector: {}
    # promtheus: kube-prometheus

    # -- Prometheus ServiceMonitor namespace
    namespace: ""
    # -- Prometheus ServiceMonitor labels
    additionalLabels: {}